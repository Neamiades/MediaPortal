#region usingsusing System;using System.Web.Mvc;using Microsoft.ApplicationInsights;#endregionnamespace MediaService.PL.Utils.Attributes.ErrorHandler{    [AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = true)]    public class AiHandleErrorAttribute : HandleErrorAttribute    {        public override void OnException(ExceptionContext filterContext)        {            if (filterContext?.HttpContext != null && filterContext.Exception != null)            {                if (filterContext.HttpContext.IsCustomErrorEnabled)                {                    var ai = new TelemetryClient();                    //todo: Do we need this, or AI good log AggregateExeption by themself?                    //if (filterContext.Exception.InnerException != null)                    //{                    //    if (!(filterContext.Exception.InnerException is AggregateException innerEx))                    //    {                    //        ai.TrackException(filterContext.Exception.InnerException);                    //    }                    //    else                    //    {                    //        foreach (var innerException in innerEx.InnerExceptions)                    //        {                    //            ai.TrackException(innerException);                    //        }                    //    }                    //}                    ai.TrackException(filterContext.Exception.InnerException ?? filterContext.Exception);                }            }            base.OnException(filterContext);        }    }}